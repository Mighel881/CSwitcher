WIP and a complete rewrite of the original. 
